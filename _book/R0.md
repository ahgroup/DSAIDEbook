--- 
title: "Infectious Disease Epidemiology<br>- a Model-based Approach (IDEMA)"
author: "Andreas Handel"
date: "2020-08-20"
site: bookdown::bookdown_site
output: 
    bookdown::gitbook:
        highlight: zenburn
        css: ./idemabook.css
        fig_caption: true
        keep_md: true
        config:
            toc:
              collapse: none
            toolbar:
              position: fixed
            edit: null
            download: no
    # bookdown::pdf_book:
    #     keep_tex: yes
    #     toc: true
    # bookdown::word_document2: 
    #     toc: true
bibliography: idemabook_references.bib
biblio-style: apalike
documentclass: book
link-citations: yes
description: "A modern, model-based approach to infectious disease epidemiology"
---

# Preface {-}

Placeholder



<!--chapter:end:index.Rmd-->


# Overview of this book

Placeholder


## Rationale for this book
## What this book does and does not cover
## How to use this book
## Computer exercises
## Recommended complementary resources
## References

<!--chapter:end:05-BookOverview.Rmd-->


# Introduction to the Dynamical Systems Approach {#idintro}

Placeholder


## Overview and Learning Objectives
## Introduction 
## Systems Thinking
## Systems Thinking and Models
### Phenomenological (statistical) Models
#### A few more comments regarding phenomenological models {#mynotebox}
### Mechanistic Models
### Dynamical Models
### Types of Dynamical, Mechanistic Models
## Systems approaches in ID Epidemiology 
## A Basic Infectious Disease Systems Model
#### Notes {#mynotebox}
#### Model Implementation {#myadvancedbox}
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:100-IDDynamicsIntro.Rmd-->


# Characterizing Infectious Disease States {#idstates}

Placeholder


## Overview and Learning Objectives
## Introduction
## States of susceptibility
## States of Infection 
### Latent infection
### Symptomatic infection
### Asymptomatic infection
## Post-infection states 
## Medical versus ID dynamics perspectives
## Models with more details
## How much detail is needed?
## Case study examples
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:110-CharacteristicsofID.Rmd-->


# Patterns of Infectious Disease Dynamics

Placeholder


## Overview and Learning Objectives
## Introduction
## Resource Replenishment
## A Model with Resource Replenishment 
#### Notes {#mynotebox}
#### Mathematical Equations for the Model with Resource replenishment {#myadvancedbox}
## Intrinisic Cycles 
## Intrinisic Cycles and models 
## External Drivers of Cycles
#### Notes {#mynotebox}
## Steady states
#### Steady States and Models {#myadvancedbox}
## Detecting cycles or other patterns
## ID Dynamics in Changing Populations
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:120-PatternsofID.Rmd-->

# Reproductive Number  {#R0}


## Overview and Learning Objectives
The reproductive number is a fundamental concept in infectious disease epidemiology. It is so important, it even made its way into (at least) one mainstream movie [@contagionmovie]! It is simple in its definition and rather useful. The hard part is to correctly estimate the reproductive number for a given disease and scenario. 
We will discuss all these aspects in the following.

The learning objectives for this chapter are:

* Know how the reproductive number is defined
* Kow how to compute the reproductive number from data
* Apply the reproductive number concept to ID control


## Introduction 
We generally want to prevent infectious diseases from causing outbreaks, stop already ongoing outbreaks, reduce the number of people getting infected, or even bolder, try to eradicate a disease. 
If we were able to make a vaccine against an infectious disease, it is useful to know what fraction of the population should be vaccinated to prevent future outbreaks or even eradicate the disease.

Assume you asked the "person on the street" the question: "If we wanted to prevent a potential future SARS outbreak, what fraction of the U.S. population do we need to vaccinate to make a large-scale outbreak impossible?" 
I suspect that most people would likely say that nearly everyone needs to be vaccinated to prevent outbreaks. A smaller number of people might realize that we don't need to vaccinate everyone, just enough people to sufficiently reduce the disease's transmission potential. To reach the second answer, one needs to have thought about how infectious diseases 'work'. 

If you happen to come across an ID public health specialist or ID modeler, you might get a different answer. Namely, they might provide you with a quantitative estimate of the fraction of people that need to get vaccinated. They might, for instance, tell you that we would need to vaccinate around 70% of the population. This is, of course, the best kind of information. How do we figure this out? That's where the reproductive number concept comes into play.

## Reproductive number definition
The concept and definition of the reproductive number are rather straightforward: The reproductive number (usually abbreviated with R), is defined as the average number of secondary infectious cases caused by one infectious individual (before they recover or die or are otherwise not able to further transmit). The following figure illustrates the concept.

![Schematic showing the definition of the reproductive number. Each person `produces' *on average* 2 other infectious individuals. (Of course, we would usually need to have more data than shown in this figure to properly estimate R.)](./images/R0scheme.png)

From this definition of the reproductive number, it is clear that if the value is greater than 1, the pathogen keeps spreading to more and more people and we have a growing outbreak. Conversely, if R is less than 1, the outbreak will fizzle out. Because of this characteristic, it is important to know R for a given outbreak, which will then tell us how stringent the interventions need to be to bring the outbreak under control. This is more explained in the following sections.

## Reproductive number details
Let's look a bit closer at the definition for R. First, note that it applies to population **averages**. A single person might infect none, a few or many others. R does not capture this detail. It only describes the average. That's why it is, for instance, possible to have R=2.5 or other non-integer numbers. Of course, it is not possible for an individual to infect 2.5 others, but since R describes an average, such fractional infections are possible. This **population average** feature of R is a strength since it makes R relatively easy to determine. It is also a weakness since often we'd like to know the distribution in addition to the mean/average - we'll discuss that when we deal with ideas such as population heterogeneity, core groups, and super-spreaders in later chapters.

Another point to note is that the definition is about the number of new **infectious** hosts produced by one infectious host. For some diseases, being infected and being infectious are pretty much the same. E.g. pretty much everyone who is infected with HIV is also - to some degree - infectious. For other diseases, that is not the case. For instance, the majority of people who get infected with TB will never reach a state where they are infectious. To compute R, we do not count the average number of individuals an infectious person infects, but only those that later go on to become infectious themselves. The same idea applies when we talk about diseases that have multiple hosts. R is defined as the number of infectious hosts 'produced' by one infectious host of the same type. For instance, for vector-borne diseases, R would be the number of infectious humans 'produced' by one infectious human via the intermediary mosquito/vector stage. While conceptually still straightforward, measuring and computing R/R~0~ in such multi-host situations can get tricky.



## Basic reproductive number
A special case of the reproductive number is at the beginning of an outbreak when essentially everyone in the population is susceptible. In this case, when we assume everyone is susceptible, we define a special quantity called the *basic* reproductive number, abbreviated as R~0~. 
The quantity R~0~ is a measurement of the transmission potential of a disease in a particular setting. It does by definition not change during an ongoing outbreak. The more general definition of the reproductive number, R, does change during an epidemic. We'll discuss that more below.


## Reproductive number terminology
While I will be mainly using the term reproductive number, there are alternative names for R. In general, any combination of reproductive/reproduction and ratio/number is ok terminology. In its early days, R was called reproductive rate. This is *incorrect* terminology and should not be used. R is **not** a rate (there are no units of  inverse time). Why does that matter? See the 'R is not a rate' box for an example. Unfortunately, old habits die slowly and you can still see the word `rate' applied to the reproductive number in some recent publications.


#### Why R Is Not a Rate - Example  {#myexamplebox}
It is important to understand that R only provides a measure of how transmissible a pathogen is, R does **not** provide any information about the speed at which transmission occurs. This is an important limitation of R. Consider 2 infections with the similar reproductive number, say HIV and SARS, which are both estimated to have a reproductive number of around 3-4. If we let an outbreak 'run its course', we would - based on R - expect to get the same number of infected individuals. However, the dynamics at which those infections occur will be quite different. SARS spreads rapidly, i.e. an infected person infects 3-4 others within a few weeks. On the other hand, a person infected with HIV will infect others on a timeframe of years. These different dynamics have of course important implications on the control approaches against diseases. Thus, while knowing R is significant for a given disease, it doesn't tell 'the full story'. 

#### Notes {#mynotebox}
While we often say "Infectious disease X has an R~0~ of Y", this is only an approximation. R and R~0~ also depend on the setting. The potential for transmission for many ID is much higher in for instance crowded locations (prisons, slums, cruise ships), or among "high risk groups" (e.g. STD in sex workers). For example in most countries R~0~ of HIV is below 1 in the general population but HIV is not disappearing because it has an R~0~ > 1 in certain subgroups. The importance of such population heterogeneity is further discused in chapter \@ref(heterogeneity) . When we talk about R, it is therefore useful to be as specific as possible about the scenario/population/setting.

In this book, and in the literature in general, you will foten find the use of R~0~, R or _effective R_ (R~eff~) used (sloppily) in an interchangeable manner. Usually, it is clear from the context if the symbol refers specifically to ~R~0 at the beginning of an outbreak in a susceptible population, or more generally to R, the average number of secondary infectious cases produced by one infectious individual in any population.

Unfortunately, _R_ seem to be a very popular letter. In the context of infectious disease dynamics, _R_ is used both to indicate the removed compartment in an SIR model, and as abbreviation for the reproductive number. To make things worse, it is also the name of the programming language which I used to write the DSAIDE package which accompanies this book. You will just have to figure out from the context if a reference to _R_ means "computer software" or "removed compartment" or "reproductive number". Fortunately, it should always be clear what is meant.


## Outbreaks and the Change in R
As stated above, at the beginning of an outbreak, a specific disease in a certain setting will have some value R~0~. As the outbreak progresses, more and more hosts become infected and - for many diseases - either die or recover and become immune to further infection. This leads to a reduction in the reproductive number as the outbreak progresses. For instance, at the start of the epidemic with everyone susceptible, R~0~=3. Then once a third of the population have become infected and immune, an infectious person who would have infected three others at the beginning of an outbreak now 'wastes' one of their transmissions on an already immune person, and therefore only infects two others. Similarly, once 2/3 of the population have become infected and immune, R will have dropped to 1. At this point, the outbreak does not grow further (recall, we need R>1 for growth). Instead, the outbreak has reached its peak and now starts to decline, with R continuing to go down as fewer and fewer susceptibles remain.




## Reproductive Number and Outbreak Control
It is intuitively clear that if on average every infectious person "produces" more than one subsequent infectious person, we get a growing epidemic. In contrast, if every infectious person "produces" less than one subsequent infectious person, the pathogen might transmit a few times, but pretty soon it will disappear. Thus if we can achieve R~0~ < 1, e.g. through vaccination, we can prevent an outbreak from starting. Further, if during an outbreak we can intervene to get R < 1, the outbreak is going to fizzle out. Figure \@ref(fig:R0intervention) illustrates this idea. If we wanted to stop _any_ further transmission, we would need to get R even lower, namely R = 0. Intervention efforts try to achieve an R as small as possible. If we could achieve R~0~ < 1 globally everywhere, we could eventually eradicate a disease. The ability to do that depends on many factors. One important one is the R~0~ value of any ID before we start an eradication campaign. Intuitively, the higher R~0~, the harder it will be to get it to < 1. We'll make that more explicit below.

<div class="figure">
<img src="./images/R0intervention.png" alt="Impact of an Intervention on transmission." width="864" />
<p class="caption">(\#fig:R0intervention)Impact of an Intervention on transmission.</p>
</div>



#### R and Outbreak Control - Example {#myexamplebox} 
During the large Ebola outbreak in West Africa which started in 2013, a few Ebola patients came to the U.S., and the goal was to have R = 0, i.e. no ongoing transmission. That didn't quite happen, a few new individuals got infected, but R was very close to zero. In contrast, in West Africa, there was little hope to get R = 0 quickly. Fortunately, R < 1 is enough. So we can 'tolerate' a few further transmissions and new cases and still get the outbreak under control eventually. Of course, in general, we want to get R as close to 0 as possible, especially for a disease as deadly as Ebola. But to get an outbreak to fizzle out, we only need R < 1, not R = 0. 



## Estimating Intervention Efforts based on R
Let's make the relation between response efforts and the reproductive number a bit more quantitative. As a simple example, consider an infectious disease with R~0~=2. That means on average every infected person infects two others. If we could somehow protect a bit more than half of the susceptibles, then a person who might have become infected can't become infected anymore, and the _effective R_ (sometimes called R~eff~) drops below 1. More generally, to prevent an outbreak, a fraction p = 1-1/R~0~ of the population needs to be protected (e.g. through vaccination). From this, it follows that the higher R~0~, the harder it is to control and ID. This is illustrated in figure \@ref(fig:krR0intervention). One can see both from the figure and the equation that a disease with say R~0~ = 5 requires that 80% of the population is protected such that R~eff~ = 1.

The level of population protection at which R=1 is called critical population (or herd) immunity level. The relation between basic reproductive number, intervention coverage, and effective R is R= R~0~(1-p). That holds true if we assume that the intervention fully protects those to whom it is applied. If the intervention is not perfect, we have R=R~0~(1-e*p), where e is the effectiveness of the intervention (e=1 is an entirely effective intervention).


<div class="figure">
<img src="./images/kr-R0intervention.png" alt="R~0~ and Interventions. From [@keeling08]." width="4263" />
<p class="caption">(\#fig:krR0intervention)R~0~ and Interventions. From [@keeling08].</p>
</div>



#### R and the SIR Model {#myadvancedbox}
We can connect the concept that R>1 leads to growth and R<1 leads to a decline in infectious persons with the simple SIR model for an outbreak. The model, which we saw earlier, is given by the following set of differential equations (Don't confuse the _R_ for the recovered with the R/R~0~ from the reproductive number. Unfortunately it is customary to use the same letter for both.):

$$ 
\begin{aligned}
\dot S &= - b SI \\
\dot I &= b S I - g I \\
\dot R &= g I
\end{aligned}
$$
For this model, what needs to be true to get an increase in the number of infectious hosts? The influx of new infectious hosts, bSI, needs to be larger than the outflow, gI. This condition, bSI > gI, can be rewritten as 1 < (bS)/g. We then define the quantity on the right side of this condition as the reproductive number, R = (bS)/g. At the beginning of an outbreak, where everyone is assumed to be susceptible (written as S= S~0~), we have the special case of the basic reproductive number, R~0~ = (bS~0~)/g. Note that the rate of recovery, g, is related to the average duration of infection, D as D=1/g. Therefore, one can also write R = DbS, with the special case R~0~ for S=S~0~, i.e. at the beginning of an outbreak.




## How to determine R 
Knowing the reproductive number for a particular pathogen and scenario is important to allow for adequate intervention planning. There are multiple ways to estimate R from data. We'll briefly discuss them now.


### Determine R at the Beginning of an Outbreak 
Very early in an outbreak, there will only be a few cases, and they occur seemingly randomly/stochastically. If the outbreak continues growing after a while, the case numbers will increase exponentially. The exponential growth rate, r, can be estimated from the data, essentially by fitting a straight line to the logarithmic values of the case report data. To go from the growth rate to R, we need some further information. Namely, we need to know the serial interval. The serial interval, T, is the time between onset of infection in one host to the onset of infection in a secondary host. Sometimes T can be approximated by the duration of the infectious period, D.

Once we know r and T, we can compute R. There are different equations relating r and T to R, they depend on specific assumptions one makes about the disease. One relation between r, T, and R is given by R = 1 + rT, and another one is given by R = e^rT^ . For assumptions underlying these equations and further details, see e.g. [@wallinga07].


<div class="figure">
<img src="./images/viboud-R0.png" alt="Example of R0 estimation based on case data in the early stages of an outbreak. Source: Viboud et al 2006 Vaccine [@viboud06]." width="4483" />
<p class="caption">(\#fig:viboudR0)Example of R0 estimation based on case data in the early stages of an outbreak. Source: Viboud et al 2006 Vaccine [@viboud06].</p>
</div>



### Determine R Once the Outbreak is Over
A larger R leads to a larger outbreak (ignoring things like interventions, behavior change, etc.). The reason to determine R is so we can use it to predict the expected size of an (uncontrolled) outbreak - and more importantly, we can learn how strong our intervention efforts need to be. But we can also flip things around. Once an (uncontrolled) outbreak has occurred, knowing the outbreak size can allow us to estimate R. It is often possible to determine outbreak sizes after an outbreak has occurred, e.g. through serosurveys which show antibodies against the disease and therefore indicate who got infected. We don't need any 'timing' information, just the fraction infected at the end. Essentially, we need to know the number of people that got infected, and the number of people who were at risk (i.e. the susceptibles) at the beginning of the outbreak. Once we know these pieces of the puzzle, we can estimate R.

More specifically, assume we know the final size of the outbreak, i.e. total fraction of those becoming infected, I~f~ = I~tot~/N, where N is the population at risk and I~tot~ is the total number of infected. We then also know the fraction of susceptibles that are left at the end of an outbreak, S~f~=1-I~f~. To find R/R~0~, we can use the equation R=_ln_(S~f~)/(S~f~ - 1) (here, _ln_ is the natural logarithm). The figure below shows the relation between the fraction infected and R~0~ graphically.


<div class="figure">
<img src="./images/outbreaksize.png" alt="The relation between R~0~ and outbreak Size. If we have information about the size of an outbreak (in the absence of control measures), we can use it to estimate R~0~. Source: Keeling and Rohani 2008 [@keeling08]." width="3380" />
<p class="caption">(\#fig:outbreaksize)The relation between R~0~ and outbreak Size. If we have information about the size of an outbreak (in the absence of control measures), we can use it to estimate R~0~. Source: Keeling and Rohani 2008 [@keeling08].</p>
</div>


For the above equation to be true, we assume that initially everyone is susceptible and that the population is well mixed. More refined estimates for R, with more complicated equations, are available [@ma06].


### Determining R at the Endemic/steady state
For an ID that is at an endemic/steady state, we have another way of determining R~0~. At the endemic equilibrium, the reproductive number is R~eq~ = 1. If it weren't, the ID would either grow or decline, and it wouldn't be the endemic state. At this endemic state, a fraction of the population is still susceptible, S~eq~. By definition, at the beginning of an ID with transmissibility R~0~, everyone is susceptible (S~0~=1, expressed as a fraction). If we know S~eq~, we can then compute R~0~ as given by R~0~ = R~eq~ S~0~/S~eq~ = 1/ S~eq~. As an example, if at an endemic state (with R~eq~=1), 50% of the population is susceptible, then at the beginning, when 100% of the population was susceptible, we have R~0~=2. Conversely, if we know R~0~, we can predict the number of susceptibles at the endemic state, S~eq~=1/R~0~.



### Determining R Through Age of Infection
For those ID for which an infection induces life-long immunity, i.e. where a host can only be infected once, the age of infection is an important concept. Intuitively, the more infectious a disease is, the more likely it is that a host gets an ID at an early age. For an ID that induces immunity, one can collect serological data (i.e. antibody measurements) to determine the fraction of individuals of a given age who have antibodies, which means they have been previously infected (assuming for the moment that no vaccine is available). One can define the median age of infection as the age at which 50% of the population has been infected.


<div class="figure">
<img src="./images/R0age.png" alt="Fraction seropositive (previously infected) as function of age for measles. Source [@keeling08]." width="4263" />
<p class="caption">(\#fig:R0age)Fraction seropositive (previously infected) as function of age for measles. Source [@keeling08].</p>
</div>

For a simple model with certain assumptions [@keeling08], one can find an approximating equation connecting the median age of infection and the basic reproductive number with the equation $A \approx \frac {L}{R_0 - 1}$ or rewritten $R_0 \approx \frac{L}{A} + 1$. In this equation, _L_ is the average life expectancy of a host and _A_ is the median age of infection. This shows what we expect intuitively: Higher R~0~, i.e. more infectious ID, leads to an earlier age of infection.

#### Note {#mynotebox}
If you want to determine R/R~0~ to be used as parameter in a mathematical transmission model, you use this approach based on the age-seroprevalence relation even if the model you plan on using doesn't have age in it.


### Determining R Through Fitting a Full Transmission Model 
Instead of just using data for the initial exponential growth phase, determining _r_ and computing R~0~ as specified above, we can fit some or all outbreak data to an SIR type model. We use the data to estimate the parameters of the model. For instance, for the simple SIR model, we would estimate the transmission rate, b, and recovery rate, g. We can then use the equation for R~0~ for a given model to compute its value. For the simple SIR model, that would be R~0~ = bS~0~/g. 



#### Computing R for a Given Model {#myadvancedbox}
Once a mathematical model for a given ID and setting has been specified, it is often useful to compute R~0~ for the model. Above, we looked at one way to get R~0~ for the basic SIR model, i.e. we determined that bS/g needs to be greater than 1 and that turned out to be R~0~. However, it is often better to derive R~0~ for a given model by starting with the basic definition: R~0~ is the average number of secondary infections caused by one infected individual, assuming the population is fully susceptible. We can then reason as follows: An individual infected person infects new susceptibles at a rate b S~0~, for a duration of 1/g. Therefore the total number of newly infected individuals is bS~0~/g. Let's apply the same reasoning to a few variations of the SIR model. Consider the following SIR model with an additional, disease-induced mortality at rate _m_. 

$$ 
\begin{aligned}
\dot S &= -b SI \\
\dot I &= b S I - g I - m I\\
\dot R &= g I
\end{aligned}
$$

An individual infected again infects at rate b*S. The average duration for which an individual is infectious is now 1/(g + m), i.e. the sum of all the outflows out of the _I_ compartment. That's a general rule: The average duration of stay in a given compartment is the inverse of the sum of all the outflows. Therefore, for this model, we now get R~0~ = b*S~0~/(g+m). Computing R for larger models can get complicated. There are specific methods one can use for more complex models. See for instance [@diekmann10] for further information on this.


## R and model parameterization 
Knowing R is not only essential for public health intervention planning, but it is also an important component of building and analysis of infectious disease models. Most models have a parameter for the transmission rate, such as _b_ in the models above. To allow simulation of a model, all parameters need to get assigned specific values - chosen to correspond to the disease and scenario under study. Direct estimates of the transmission rate for a model are usually hard to find. Instead, we often determine R/R~0~ for a given ID/setting and then use it to compute _b_ using equations like those shown above.


## Case studies

### Basic Science example: Estimating the reproductive number for the 1918 influenza pandemic

_To come_

### Policy/Application example: Estimating the reproductive number of the 2014 Ebola outbreak

_To come_


## Summary and Cartoon

The reproductive number is a crucial concept in infectious disease epidemiology. It has a relatively straightforward definition. However, estimating R for a specific disease and scenario is not always easy. 

Under the assumption that everyone is susceptible, the reproductive number gets the special name *basic reproductive number* and is a denoted by R~0~. Knowing R/R~0~ helps in planning the scale of interventions.

R only measures one -- important -- component of a disease, namely its transmission potential/transmissibility. For a full understanding of a given disease, we need to know other characteristics such as speed of transmission, the severity of disease including mortality, routes of transmission, and other disease specific details.

The simplicity of R is both its strength and its weakness. It gives a quick, quantitative assessment of the transmission potential (and therefore outbreak size and needed control measures) of a disease. However, R is a population level average and ignores heterogeneities of host, agent, and environment. Therefore any R estimates are only approximate.


<div class="figure">
<img src="./images/xkcd-outbreak-control.png" alt="The R~0~ in this case was 0. [Source: xkcd.com](https://xkcd.com/734/)." width="740" />
<p class="caption">(\#fig:xkcd-outbreak-control)The R~0~ in this case was 0. [Source: xkcd.com](https://xkcd.com/734/).</p>
</div>




## Exercises
* The _Reproductive Number_ app in the DSAIDE package provides hands-on computer exercises for this chapter.
* Find a paper from the research literature that provides evidence for herd immunity for a specific infectious disease and setting. Summarize the paper and explain how it demonstrates the occurrence of herd immunity.
* Read the paper "Herd Immunity: A Rough Guide" by Fine et al. [@fine11]. In this paper, the authors mention _"...the complexities of imperfect immunity, heterogeneous populations, nonrandom vaccination, and freeloaders..."_. For each of those complexities, find, read and summarize a research paper that discusses the topic. Ideally, choose papers other than those already cited by Fine et al. 
* Compute R~0~ following the scheme described in this chapter for the following model, which has an additional compartment of exposed, not-yet infectious hosts (we called those _P_ in previous models).  Note that you always go "full circle", i.e. from one infectious individual back to infectious individuals: $\dot S = -b SI, \ \dot E = b S I - a E, \ \dot I = a E - g I - m I, \ \dot R = g I$.
* Compute R~0~ following the scheme described in this chapter for the following model, which includes births and deaths:
$\dot S =m - b SI - n S, \ \dot E = b S I - a E - n E, \ \dot I = a E - g I - n I, \ \dot R = g I - n R$. (Note that in the previous exercise, the parameter _m_ represents disease-induced mortality, here it represents births. I'm purposefully re-cycling it, so you get used to the fact that different papers/people use different letters for parameters. Always read carefully.)



## Further Resources
* The following papers provide further discussions and details on the reproductive number: [@heffernan05; @roberts07; @li11].
* Further discussions regarding herd immunity can be found in [@metcalf15; @fine93].


## References




<!--chapter:end:130-ReproductiveNumber.Rmd-->


# Types of Infectious Disease Transmission

Placeholder


## Overview and Learning Objectives
## Introduction
## Direct Transmission
## Environmental Transmission
## Vector-borne Transmission
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:135-TransmissionTypes.Rmd-->


# Modes of Direct Transmission

Placeholder


## Overview and Learning Objectives
## Introduction
## Contact transmission
## Airborne transmission
## Ways in which direct transmission scales
### Modeling types of direct transmission {#myadvancedbox}
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:140-DirectTransmissionModes.Rmd-->


# Environmental Transmission

Placeholder


## Overview and Learning Objectives
## Introduction
## Environmental transmission basics
## Environmental transmission and external drivers
## Environmental transmission and interventions
#### Modeling environmental transmission {#myadvancedbox}
## Case study examples
### Basic Science example: Environmental transmission for Cholera
### Policy/Application example: 
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:150-EnvironmentalTransmission.Rmd-->


# Vector-borne transmission

Placeholder


## Overview and Learning Objectives
## Introduction
## Vector-borne transmission and ID patterns
## Vector-borne transmission and interventions
#### Modeling vector-borne transmission {#myadvancedbox}
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:160-VectorBorneID.Rmd-->


# Host Heterogeneity {#heterogeneity}

Placeholder


## Overview and Learning Objectives
## Introduction
## Types of Host Heterogeneity 
#### Host Heterogeneity Examples {#myexamplebox}
## Heterogeneity in Transmission: Core Groups
## Heterogeneity in Transmission: Superspreaders
## Heterogeneity and The Reproductive Number
## Heterogeneity and ID control
## Modeling Heterogeneity
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:165-HostHeterogeneity.Rmd-->


# Infectious Disease Control

Placeholder


## Overview and Learning Objectives
## Introduction
## Goals of ID Control
## Types of Infectious Disease Control
### Vaccination
### Pharmaceutical Interventions (Drugs)
### Non-pharmaceutical Interventions 
### Special Interventions for Non-human Hosts
## Characteristics of Interventions
## Impact of Interventions
## Interventions and Models
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:170-IDControl.Rmd-->


# Infectious Disease Surveillance

Placeholder


## Overview and Learning Objectives
## Introduction
## Goals of Surveillance
## Types of Surveillance
## Problems with surveillance
#### Biased Surveillance - an example {#myexamplebox}
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:175-IDSurveillance.Rmd-->


# Dynamics of Multiple Pathogens

Placeholder


## Overview and Learning Objectives
## Introduction
## Interactions of ID
### HIV-TB Interactions
### HIV-Hepatitis Interactions
### Influenza-Strep Interactions
## More Than Two Infectious Diseases
## Multiple ID and Control
#### Modeling multiple ID {#myadvancedbox}
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:190-MultiPathogenID.Rmd-->


# Stochastic Dynamics and Extinctions {#stochastic}

Placeholder


## Overview and Learning Objectives
## Introduction
## Deterministic systems
## Stochasticity
## Discrete Numbers and Extinctions
## Modeling Stochasticity and Extinction
## Factors Affecting Extinction
## Critical Community Size
## Host Extinction
## Disease Emergence
## Are stochastic models better?
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:200-StochasticDynamics.Rmd-->


# Evolutionary Dynamics Introduction

Placeholder


## Overview and Learning Objectives
## Introduction
## Basics of Evolutionary dynamics
## Evolution and Immune Escape
## Modeling Evolutionary Dynamics
## Co-evolution
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:210-EvolutionaryDynamics.Rmd-->


# Evolution and Control

Placeholder


## Overview and Learning Objectives
## Introduction
## Vaccine Escape
## Drug Resistance
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:214-EvolutionandControl.Rmd-->


# Emerging Infectious Diseases 

Placeholder


## Overview and Learning Objectives
## Introduction
## Emergence and Evolution
## Ecological drivers of evolution and emergence
## Emergence dynamics
## Modeling ID Emergence Dynamics
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:215-EmergingID.Rmd-->


# Virulence

Placeholder


## Overview and Learning Objectives
## Introduction
## Virulence definition
## Virulence evolution
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:218-Virulence.Rmd-->


# Networks and ID

Placeholder


## Overview and Learning Objectives
## Introduction
## Network Terminology
## Network Nodes
## Network Connections
## Network Characteristics
## Important types of networks
## ID Transmission on Networks
## Networks and ID Control
## Modeling ID Transmission on Networks
## ID Transmission on Dynamic Networks
## Summary and Cartoon
## Exercises
## Further Resources
## References

<!--chapter:end:220-Networks.Rmd-->

# Summary

This book provided an introduction to Infectious Disease Epidemiology from a modern, dynamical systems perspective. 

While the ability to be able to develop and analyze dynamical models requires additional training and skills in mathematics and coding, I hope that this book helped you to understand such a systems modeling perspective and different ID concepts best discussed from such a perspective.

## All References



<!--chapter:end:300-Summary.Rmd-->


# Appendix A - A brief description of modeling software

Placeholder


## Overview
## R
## R packages
## The 'R universe'
## Other software
## References

<!--chapter:end:500-Appendix-Software.Rmd-->

# Appendix B - How to build or use the right model {#modelcomplexity}


Onee might be inclined to build very complicated and detailed models, in an effort to be as realistic as possible. While more detailed models can indeed be more realistic, there are several drawbacks. First, as models get larger, they contain more parameters. Each parameter needs to be given a numeric value to allow one to run simulations. One can try to obtain the parameters from the literature, however, often that information is not available. Alternatively, one could fit the model to data (something not discussed in this book) and try to estimate the parameters. However, with the kind of data typically available, one can usually only estimate a few parameters with some level of certainty. And even if one were to be able to get good estimates for all model parameters, larger models are harder to implement, take longer to run, and are more difficult to analyze. With too many parts present, it can be hard to understand how different components interact with each other and affect outcomes of interest. 

We therefore cannot - and do not want to - include every detail of a complex system, i.e. all components and interactions. We need to decide which parts are important and need to be in the model, and which ones we can ignore. A simple and somewhat silly example: We never include the hair color of individuals in any infectious disease models (at least I've never seen such a model), since we assume that this characteristic is not important for the ID dynamics. The choice to include or exclude other features is less obvious in other cases. For instance, for an HIV model, we likely need gender, while a SARS model might ignore this characteristic. 

It is important to find a trade-off between details that need to be included and details one can leave out. Unfortunately, there is no recipe for it. Some very simple models have produced useful insights, while there are big models in the literature that arguably do little to nothing in helping us understand or deal with infectious diseases. Obviously, there have also been fairly big models that have produced useful information, and small models that are too simplistic to provide much information about any real system.

A good analogy for model building and use in general is the use of maps. Maps are models of the real world. They serve specific purposes, and it is important that a given map be useful for the intended purpose. For instance, if we want to know how to drive from Atlanta to Athens, the left map in figure \@ref(fig:mapfigure) would be most useful. If instead we want to know where in the US the state of Georgia is located, the middle map is most useful. If we want to know where most people live in Georgia, the right map is most useful. In each case, we study the same object (the state of Georgia), but depending on the question, different maps are needed. Maps (and models) are useful because they capture the information that is needed for a specific situation, while leaving out unneccesary information. Nobody would want to have a map so detailed that it is essentially the real world - it wouldn't be a very useful map anymore.


<div class="figure">
<img src="./images/mapfigure.png" alt="Three different maps of the state of Georgia." width="7603" />
<p class="caption">(\#fig:mapfigure)Three different maps of the state of Georgia.</p>
</div>

In analogy to the map example, we need to decide for a specific ID, scenario, and question which details to include in our model and which ones to ignore. In general, the primary interactions between components of the system are needed. Thus, if we wanted to model the transmission dynamics of Ebola, we might need to include deceased infected individuals into the model, since they are known to contribute to transmission. In contrast, if we want to study how some control strategies for SARS might reduce the total number of *infected* but we don't care about the impact on total deaths (unlikely, but let's just pretend). In this case, we would not need a dead compartment in our model, since those dead don't further interact with anyone else in the system. However, if we want to keep track of deaths and how they are impacted by our intervention (likely), we do need to track them - even though dead people are not known to transmit SARS. 

To build models that are suitable to study a particular system, model builders need to be experts on the system they want to study or collaborate with subject matter experts. Building a good model needs to follow the [Goldilocks Principle](https://en.wikipedia.org/wiki/Goldilocks_principle): If a model is too simple, it likely doesn't approximate the real system very well. If the model is too complicated, it is hard to build and analyze, and might not lead to much insight (i.e. the model is a big black box). The goal is to get the model _just right_ regarding size and complexity. Unfortunately, no recipe or formula exists specifying how to build a _just right_ model. Using models that are suitable for a given system and question is a hallmark of a good scientist.

The model building and analysis process is often iterative. After a model has been built and studied, it might become clear -- e.g. by comparing the model with data -- that important components or interactions have been ignored or not been included correctly. This leads to model modification and refinement. This back and forth between model and data/the real world can happen over multiple iterations.


Note that for purposes of teaching, we keep the models throughout this book fairly simple. The models will include the feature we are focusing on while excluding others. For instance, we include humans and mosquitos for vector-borne IDs but ignore things like asymptomatic or pre-symptomatic states. This is mainly done to keep models simple and focus on one feature at a time. Models that address "real" questions often -- but not always -- include more details than the models we investigate througout this book.


## References



<!--chapter:end:505-Appendix-ModelComplexity.Rmd-->

# Appendix C - The different uses of Infectious Disease models


## Overview
There are different ways one can categorize the uses of the mechanistic models we discussed here. The following is one useful way of thinking about model uses. 

## Exploring/Understanding 
At the early stages of trying to gain a fairly basic understanding of the behavior of a system, one can build simple mechanistic models and explore how interactions between model components (and thus components of the real system) impact observed patterns. Using models in this way provides a quick and cheap way to gain some intuition of how a system functions. For understanding purposes, one generally tries to keep models simple.

## Prediction/what-if
Once we have gained some general understanding of the system under study and know enough about the system to be able to build models that provide reasonable approximations of the real system, we can use those models to perform _in silico experiments_. We can make predictions what might happen to the system if we changed some of its parts. For instance in a model that includes some cytokine, we could test what would happen if we administered a drug that suppressed this cytokine. This allows us to make predictions that can be tested with further experiments. These _in silico_ approaches are much faster, cheaper and have no ethical problems, compared to real experiments. Of course the major caveat with any model result is that it is only useful insofar as the model properly captures the important features of the real system. The more a model is used to make predictions and these predictions tested with data, the more reliable it becomes.

## Fitting/inference
The previous two ways of using a model can be considered _data free_. What we mean by that is that while models should obviously be built based on the best information about the system, and model parameters need to come from experiments or other data sources, once the model is built it can be run and analyzed without further need for data. Comparing model predictions with data, as described in the previous paragraph, is a first step toward using data together with models. If one makes the model-data comparison in a rigorous statistical manner, one reaches the area of model fitting (inference). Here, one tries to fit a specific mechanistic model to available data in a rigorous statistical manner (using various approaches such as frequentist, likelihood or bayesian methods). Fitting allows one to discriminate between different postulated mechanisms (hypotheses), which are translated into different models and fitting determines which model is better at explaining the observed data. Further, model fitting provides estimates for model parameters. Often, such parameters have a directly interpretable biological meaning (e.g. the rate of virus production by infected cells) and are thus of interest on their own.


## References



<!--chapter:end:510-Appendix-ModelUse.Rmd-->

# Appendix D - A very brief introduction to data fitting



## Overview

Throghout this book, we have tried to connect the real world and data to models. In some chapters, we described how one can directly use data to estimate quantities of interest (e.g. the reproductive number chapter).


## Conceptual Ideas



## Technical details




## References



<!--chapter:end:550-Appendix-Fitting.Rmd-->

# Appendix E - Glossary of terms {#glossary}

The following provides very short explanation of commonly used terms. As applicable, references pointing to further details are provided.


__Incidence__ 

__Prevalence__

__endemic__

__zoonosis__



<!--chapter:end:600-Glossary.Rmd-->

# References {#references}


<!--chapter:end:900-References.Rmd-->

